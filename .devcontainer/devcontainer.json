{
    "name": "Azure CAF module",

    // Container user to use in VSCode Online and GitHub Codespaces
    "image": "aztfmod/rover-preview:1.7.5-2404.221518",
    "remoteUser": "vscode",

    // Volume mounts for the container.
    "mounts": [
        "source=volume-caf-vscode,target=/home/vscode",
        "source=volume-caf-vscode-bashhistory,target=/commandhistory",
        "source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind",
        "source=${localEnv:HOME}${localEnv:USERPROFILE}/.ssh,target=/home/vscode/.ssh,type=bind,consistency=cached"
    ],

    // Adding features to the container.
    "features": {
        "ghcr.io/devcontainers/features/docker-outside-of-docker:1": {},
        "ghcr.io/mickeahlinder/devcontainer-features/tfenv:1": {}
    },

    // Container run arguments.
    "runArgs": [
		"--cap-add=SYS_PTRACE",
		"--security-opt",
		"seccomp=unconfined",
		"--init"
	],

    // Workspace mounts and environment variables can be added here.
    "workspaceMount": "source=${localWorkspaceFolder},target=/tf/caf,type=bind",
    "workspaceFolder": "/tf/caf",


    // Uncomment the next line to run commands after the container is created.
	"postCreateCommand" : "sudo chmod 400 ~/.ssh/* && git config --global core.editor vi && pre-commit install && pre-commit autoupdate",
    // "postCreateCommand": "sudo cp -R /tmp/.ssh-localhost/* ~/.ssh && sudo chown -R $(whoami):$(whoami) /tf/caf ~/.ssh && sudo chmod 400 ~/.ssh/* && git config --global core.editor vi && pre-commit install && pre-commit autoupdate",


    // Adding the extensions you in the container.
    "customizations": {
        "vscode": {
            "extensions": [
				"hashicorp.terraform",
				"mutantdino.resourcemonitor",
				"eamodio.gitlens",
				"GitHub.copilot"
			]
        }
    }


}
